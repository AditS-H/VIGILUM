services:
  postgres:
    image: postgres:17-alpine
    environment:
      POSTGRES_USER: vigilum
      POSTGRES_PASSWORD: vigilum
      POSTGRES_DB: vigilum
    ports:
      - \"5432:5432\"
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:8-alpine
    ports:
      - \"6379:6379\"

  qdrant:
    image: qdrant/qdrant:latest
    ports:
      - \"6333:6333\"
      - \"6334:6334\"
    volumes:
      - qdrant_data:/qdrant/storage

  clickhouse:
    image: clickhouse/clickhouse-server:latest
    ports:
      - \"8123:8123\"
      - \"9000:9000\"
    volumes:
      - clickhouse_data:/var/lib/clickhouse

  nats:
    image: nats:latest
    ports:
      - \"4222:4222\"
      - \"8222:8222\"

  temporal:
    image: temporalio/auto-setup:latest
    ports:
      - \"7233:7233\"
    environment:
      - DB=postgresql
      - DB_PORT=5432
      - POSTGRES_USER=vigilum
      - POSTGRES_PWD=vigilum
      - POSTGRES_SEEDS=postgres
    depends_on:
      - postgres

  temporal-ui:
    image: temporalio/ui:latest
    ports:
      - \"8080:8080\"
    environment:
      - TEMPORAL_ADDRESS=temporal:7233
    depends_on:
      - temporal

  jaeger:
    image: jaegertracing/all-in-one:latest
    ports:
      - \"16686:16686\"
      - \"4317:4317\"
      - \"4318:4318\"

  prometheus:
    image: prom/prometheus:latest
    ports:
      - \"9090:9090\"
    volumes:
      - ./config/prometheus.yml:/etc/prometheus/prometheus.yml

  grafana:
    image: grafana/grafana:latest
    ports:
      - \"3000:3000\"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
    volumes:
      - grafana_data:/var/lib/grafana

volumes:
  postgres_data:
  qdrant_data:
  clickhouse_data:
  grafana_data:
